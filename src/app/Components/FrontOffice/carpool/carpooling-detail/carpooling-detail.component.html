<div class="carpool-detail-container">
  @if (carpoolDetails) {
    <h2 class="carpool-title">Carpool Details</h2>
    <div class="carpool-info">
      <!-- Carpool Information -->
      <div class="info-section">
        <h3 class="section-subtitle">Carpool Information</h3>
        <div class="info-grid">
          <p><strong>Departure:</strong> {{ carpoolDetails.carpoolDeparture || 'N/A' }}</p>
          <p><strong>Destination:</strong> {{ carpoolDetails.carpoolDestination || 'N/A' }}</p>
          <p><strong>Date:</strong> {{ carpoolDetails.carpoolDate || 'N/A' }}</p>
          <p><strong>Time:</strong> {{ carpoolDetails.carpoolTime || 'N/A' }}</p>
          <p><strong>Capacity:</strong> {{ carpoolDetails.carpoolCapacity ?? 'N/A' }}</p>
          <p><strong>Conditions:</strong> {{ carpoolDetails.carpoolCondition || 'None' }}</p>
          <p><strong>Price:</strong> {{ carpoolDetails.carpoolPrice ? carpoolDetails.carpoolPrice + ' TND' : 'N/A' }}</p>
          <p><strong>License Plate:</strong> {{ carpoolDetails.licensePlate || 'N/A' }}</p>
          <p>
            <strong>Status:</strong>
            <span class="{{ carpoolDetails.carpoolStatus === 'available' ? 'status-available' : 'status-unavailable' }}">
              {{ carpoolDetails.carpoolStatus || 'N/A' }}
            </span>
          </p>
        </div>
      </div>

      <!-- Offerer Information -->
      @if (offererDetails) {
        <div class="info-section">
          <h3 class="section-subtitle">Offerer Information</h3>
          <div class="info-grid">
            <p><strong>First Name:</strong> {{ offererDetails.firstName }}</p>
            <p><strong>Last Name:</strong> {{ offererDetails.lastName }}</p>
            <p>
              <strong>Profile Photo:</strong>
              @if (offererDetails.profilePhoto) {
                <img
                  [src]="offererDetails.profilePhoto"
                  alt="Offerer Profile Photo"
                  class="profile-photo"
                  (error)="handleImageError($event)"
                />
              } @else {
                <span class="text-muted">This user doesn't have a photo.</span>
              }
            </p>
          </div>
        </div>
      }

      <!-- Liste des participants -->
      @if (carpoolDetails.simpleUserJoin && carpoolDetails.simpleUserJoin.length > 0) {
        <div class="info-section">
          <h3 class="section-subtitle">Participants</h3>
          <ul class="participants-list">
            @for (user of carpoolDetails.simpleUserJoin ; track user.userId) {
              <li>{{ user.firstName }} {{ user.lastName }} ({{ user.email }})</li>
            }
          </ul>
        </div>
      }
    </div>

    <!-- Bouton pour rejoindre le covoiturage -->
    <div class="button-container">
      <button class="btn btn-join" (click)="joinCarpool()" [disabled]="carpoolDetails.carpoolCapacity <= 0">
        {{ carpoolDetails.carpoolCapacity <= 0 ? 'Complet' : 'Rejoindre ce covoiturage' }}
      </button>
    </div>

    <!-- Messages d'erreur et de succÃ¨s -->
    @if (errorMessage) {
      <div class="alert alert-danger">
        {{ errorMessage }}
      </div>
    }

    @if (successMessage) {
      <div class="alert alert-success">
        {{ successMessage }}
      </div>
    }
  } @else if (!errorMessage) {
    <div class="loading">
      Chargement en cours...
    </div>
  }
</div>
