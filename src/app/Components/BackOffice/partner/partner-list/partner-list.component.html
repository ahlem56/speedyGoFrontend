<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="mb-0">Partners Management</h2>
    <button class="btn btn-success" routerLink="/back-office/partners/create">
      <i class="bi bi-plus-circle me-2"></i>Add New Partner
    </button>
  </div>

  <div class="mb-4">
    <div class="input-group">
      <input type="text" class="form-control" placeholder="Search by name or code..." 
             [(ngModel)]="searchTerm" (input)="applyFilter()">
      <span class="input-group-text bg-primary text-white">
        <i class="bi bi-search"></i>
      </span>
    </div>
  </div>

  <div *ngIf="isLoading" class="text-center py-5">
    <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-2">Loading partners...</p>
  </div>

  <div *ngIf="errorMessage" class="alert alert-danger">{{ errorMessage }}</div>

  <div *ngIf="!isLoading && filteredPartners.length === 0" class="alert alert-info">
    <i class="bi bi-info-circle me-2"></i>No partners found matching your criteria.
  </div>

  <div *ngIf="!isLoading && filteredPartners.length > 0">
    <div class="table-responsive rounded-3 shadow-sm">
      <table class="table table-hover mb-0">
        <thead class="table-primary">
          <tr>
            <th scope="col" class="w-15">Code</th>
            <th scope="col" class="w-25">Partner Name</th>
            <th scope="col" class="w-30">Contact Info</th>
            <th scope="col" class="w-15">Duration</th>
            <th scope="col" class="w-15 text-end">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let partner of paginatedPartners">
            <td>{{ partner.partnerCode ?? 'N/A' }}</td>
            <td>{{ partner.partnerName }}</td>
            <td>{{ partner.partnerContactInfo ?? '-' }}</td>
            <td>{{ partner.partnershipDuration ? (partner.partnershipDuration + ' months') : 'N/A' }}</td>
            <td class="text-end">
              <div class="d-flex gap-2 justify-content-end">
                <button class="btn btn-sm btn-outline-primary" (click)="editPartner(partner.partnerId)">
                  <i class="bi bi-pencil-square"></i>
                </button>
                <button class="btn btn-sm btn-outline-danger" (click)="deletePartner(partner.partnerId)">
                  <i class="bi bi-trash"></i>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <nav *ngIf="totalPages > 1" class="mt-4">
      <ul class="pagination justify-content-center mb-0">
        <li class="page-item" [class.disabled]="currentPage === 1">
          <a class="page-link" (click)="changePage(currentPage - 1)">
            <i class="bi bi-chevron-left"></i>
          </a>
        </li>

        <li class="page-item" *ngFor="let page of getPages()" [class.active]="currentPage === page">
          <a class="page-link" (click)="changePage(page)">{{ page }}</a>
        </li>

        <li class="page-item" [class.disabled]="currentPage === totalPages">
          <a class="page-link" (click)="changePage(currentPage + 1)">
            <i class="bi bi-chevron-right"></i>
          </a>
        </li>
      </ul>
      <div class="text-center text-muted mt-2">
        Page {{ currentPage }} of {{ totalPages }}
      </div>
    </nav>
  </div>
</div>
