<div class="container mt-4">
  <h2 class="title text-center">My Affected Parcels</h2>

  <div *ngIf="parcels && parcels.length > 0; else noParcels">
    <div class="row">
      <div class="col-md-4 mb-4" *ngFor="let parcel of parcels">
        <div class="card parcel-card shadow-sm">
          <div class="card-body">
            <h5 class="card-title text-primary">Parcel {{ parcel.parcelId }}</h5>
            <p class="card-text"><strong>🚚 Departure:</strong> {{ parcel.parcelDeparture }}</p>
            <p class="card-text"><strong>📍 Destination:</strong> {{ parcel.parcelDestination }}</p>
            <p class="card-text"><strong>📦 Category:</strong> {{ parcel.parcelCategory }}</p>
            <p class="card-text"><strong>📞 Sender:</strong> {{ parcel.senderPhoneNumber }}</p>
            <p class="card-text"><strong>📞 Recipient:</strong> {{ parcel.recepeientPhoneNumber }}</p>
            <p class="card-text"><strong>⚖️ Weight:</strong> {{ parcel.parcelWeight }} kg</p>
            <p class="card-text"><strong>📅 Date:</strong> {{ parcel.parcelDate | date:'dd/MM/yyyy HH:mm' }}</p>
            <p class="card-text"><strong>💰 Price:</strong> {{ parcel.parcelPrice | currency:'TND' }}</p>
             <!-- Icon button at the bottom of the card -->
            <div class="d-flex justify-content-end mt-3">
              <!-- Bouton SHIPPED: Désactivé si le statut est "SHIPPED" -->
              <button mat-raised-button
                      color="accent"
                      class="me-2"
                      (click)="markAsShipped(parcel.parcelId)"
                      [disabled]="parcel.status === 'SHIPPED'">
                <mat-icon>local_shipping</mat-icon> SHIPPED
              </button>
              
              <!-- Bouton DELIVERED -->
              <button mat-raised-button
                      color="primary"
                      class="ms-2"
                      (click)="markParcelAsDelivered(parcel.parcelId)"
                      [disabled]="parcel.status === 'DELIVERED'">
                <mat-icon>check_circle</mat-icon> DELIVERED
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <ng-template #noParcels>
    <div class="text-center mt-5">
      <p class="alert alert-warning no-data">🚚 No parcels assigned to your account at the moment.</p>
    </div>
  </ng-template>
</div>

